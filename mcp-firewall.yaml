# mcp-firewall Policy Configuration
# This file defines the security guardrails for the keycloak-mcp-server

# Global Configuration
global:
  dashboard_port: 9090
  audit_log: audit.log
  fail_open: false  
secrets:
  enabled: true
  action: redact

# Agent Identities & RBAC (Optional)
# We handle permissions in the general rules section below
agents: {}

# General Rules (evaluated in order: FIRST MATCH WINS)
rules:
  # 1. Block directory traversal patterns (using globs)
  - name: block-traversal
    tool: "read_file|list_directory|write_file"
    match:
      arguments:
        path: "**/../*"
    action: deny
    message: "Security violation: Potential directory traversal detected."

  # 2. Block specific unauthorized directories
  - name: block-admin-access
    tool: "read_file|list_directory"
    match:
      arguments:
        path: "admin/*"
    action: deny
    message: "Access denied: The 'admin/' directory is off-limits."

  # 3. Allow access to the authorized folder
  - name: allow-claude-files
    tool: "read_file|list_directory|write_file"
    match:
      arguments:
        path: "claude-desktop/**"
    action: allow

  # 4. Default Allow for all other calls (including Keycloak tools)
  - name: default-allow
    tool: "*"
    action: allow

# Threat Feed Integration
threat_feed:
  enabled: true
  update_interval: 24h
